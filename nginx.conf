server {
  listen 80;
  server_name _;

  root /usr/share/nginx/html;
  index index.html;
  error_page 404 /404.html;

  # Explicit handlers for common text assets
  location = /robots.txt { try_files $uri =404; expires 1h; access_log off; }
  location = /sitemap.xml { try_files $uri =404; expires 1h; access_log off; }

  # SPA fallback for extensionless routes only
  location / {
    try_files $uri $uri/ /index.html;
  }

  # Asset rule: serve known extensions directly or 404
  location ~* \.(css|js|png|jpg|jpeg|gif|svg|webp|avif|ico|woff|woff2|ttf|json|map|txt|xml)$ {
    try_files $uri =404;
    expires 30d;
    access_log off;
  }

  # Custom 404 page (avoid caching the error document)
  location = /404.html {
    add_header Cache-Control "no-store, max-age=0";
    expires -1;
  }
}
