---
import "../styles.css";
const { 
  lang = 'en',
  title = lang === 'sv' ? 'Putte Arvfors â€” Webbanalytiker & Digital ProblemlÃ¶sare' : 'Putte Arvfors â€” Web Analyst & Digital Troublemaker', 
  description = lang === 'sv' ? 'Putte Arvfors â€” Webbanalytiker och Digital ProblemlÃ¶sare. Matomo-fokuserad analys, SEO/AEO/GEO, experimentering och integritetsfokuserad datahantering (GDPR).' : 'Putte Arvfors â€” Web Analyst and Digital Troublemaker. Matomoâ€‘first analytics, SEO/AEO/GEO, experimentation, and privacyâ€‘first data practices (GDPR).'
} = Astro.props;

// Define navigation and other translations based on language
const isSwedish = lang === 'sv';
const navLabels = isSwedish ? {
  about: 'Om',
  work: 'Arbete', 
  skills: 'FÃ¤rdigheter',
  certifications: 'Certifieringar',
  contact: 'Kontakt'
} : {
  about: 'About',
  work: 'Work',
  skills: 'Skills', 
  certifications: 'Certifications',
  contact: 'Contact'
};

const siteUrl = lang === 'sv' ? 'https://puttski.com/sv' : 'https://puttski.com/';
const canonicalUrl = siteUrl;

// Get current page to determine navigation behavior
const currentPath = Astro.url.pathname;
const isHomepage = currentPath === '/' || currentPath === '/sv' || currentPath === '/sv/';
const baseUrl = lang === 'sv' ? '/sv' : '/';

// Navigation URLs - use homepage anchors if on homepage, otherwise use full URLs
const navUrls = isHomepage ? {
  about: '#about',
  work: '#work', 
  skills: '#skills',
  certifications: '#certifications',
  contact: '#contact'
} : {
  about: lang === 'sv' ? '/sv#about' : '/#about',
  work: lang === 'sv' ? '/sv#work' : '/#work',
  skills: lang === 'sv' ? '/sv#skills' : '/#skills', 
  certifications: lang === 'sv' ? '/sv#certifications' : '/#certifications',
  contact: lang === 'sv' ? '/sv#contact' : '/#contact'
};
---
<!doctype html>
<html lang={lang}>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{title}</title>
    <meta name="description" content={description} />
    <meta id="meta-theme-color" name="theme-color" content="#ffffff" />
    <meta property="og:title" content="Putte Arvfors â€” Web Analyst & Digital Troublemaker" />
    <meta property="og:description" content="Matomoâ€‘first analytics, SEO/AEO/GEO, experimentation, and privacyâ€‘first data practices (GDPR)." />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="/img/H3I0509_2-600x569.jpg" />
    <meta property="og:url" content={siteUrl} />
    <link rel="canonical" href={canonicalUrl} />
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='0.9em' font-size='90'%3E%F0%9F%93%8A%3C/text%3E%3C/svg%3E" />
    
    <script>
      (function(){
        try {
          const t = localStorage.getItem('theme');
          const root = document.documentElement;
          if (t === 'light' || t === 'dark') {
            root.setAttribute('data-theme', t);
          } else {
            root.removeAttribute('data-theme'); // auto: follow system
          }
        } catch (e) {}
      })();
    </script>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@graph": [
        {"@type":"WebSite","@id":"https://puttski.com/#website","url":"https://puttski.com/","name":"Puttski â€” Putte Arvfors","inLanguage":"{lang}"},
        {"@type":"WebPage","@id":"{siteUrl}#webpage","url":"{siteUrl}","name":"{title}","isPartOf":{"@id":"https://puttski.com/#website"},"description":"{description}","inLanguage":"{lang}","about":{"@id":"https://puttski.com/#person"},"breadcrumb":{"@id":"{siteUrl}#breadcrumbs"}},
        {"@type":"Person","@id":"https://puttski.com/#person","name":"Putte Arvfors","url":"https://puttski.com/","jobTitle":"{isSwedish ? 'Webbanalytiker & Digital ProblemlÃ¶sare' : 'Web Analyst & Digital Troublemaker'}","image":"https://puttski.com/img/H3I0509_2-600x569.jpg","email":"mailto:putte@arvfors.se","sameAs":["https://www.linkedin.com/in/putte/","https://github.com/Puttrix"],"knowsAbout":["Matomo","Matomo Tag Manager","SEO","AEO","GEO","Technical SEO","Structured Data","Consent","Privacy","GDPR","Experimentation","Optimizely","Optimizely ODP","Optimizely CMS","VWO","GA4","GTM","BigQuery","Looker Studio","JavaScript","Python","Docker","GitHub Actions","GitHub","Claude Code","ChatGPT","OpenAI Codex","GitHub Copilot"],"hasCredential":[{"@type":"EducationalOccupationalCredential","name":"Google Analytics Certification","url":"https://skillshop.credential.net/ce699bf3-df60-48b9-976e-158b4f3ed17e#acc.UnmqXpbG","recognizedBy":{"@type":"Organization","name":"Google Digital Academy (Skillshop)"},"credentialCategory":"Certification","issuedBy":{"@type":"Organization","name":"Google"},"dateIssued":"2025-08","validUntil":"2026-08"},{"@type":"EducationalOccupationalCredential","name":"Server-side tagging with Stape | Certificate","url":"https://stape.io/academy","recognizedBy":{"@type":"Organization","name":"Stape"},"credentialCategory":"Certificate","dateIssued":"2025-08","identifier":"66a749616a9ac80fb105a5e5"},{"@type":"EducationalOccupationalCredential","name":"Experiment Collaboration Explorer","url":"https://academy.optimizely.com/student/award/xE9A7XyUinhuuAGgCwd419xC","recognizedBy":{"@type":"Organization","name":"Optimizely"},"credentialCategory":"Certification","dateIssued":"2025-01"},{"@type":"EducationalOccupationalCredential","name":"Optimizely Experimentation Certified Strategist â€” Core Competency 2025","url":"https://www.credly.com/badges/713ca562-f48b-4c95-b8e1-8dca63c90e57/linked_in_profile","recognizedBy":{"@type":"Organization","name":"Optimizely"},"credentialCategory":"Certification","dateIssued":"2025-01","validUntil":"2027-01"},{"@type":"EducationalOccupationalCredential","name":"Optimizely Certified Experimentation Web Platform Expert","url":"https://www.credly.com/badges/04fbba65-93a5-4ace-8fd4-67649309fa1f/linked_in_profile","recognizedBy":{"@type":"Organization","name":"Optimizely"},"credentialCategory":"Certification","dateIssued":"2024-02","validUntil":"2026-02"}]},
        {"@type":"BreadcrumbList","@id":"{siteUrl}#breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"name":"{isSwedish ? 'Hem' : 'Home'}","item":"{siteUrl}"},{"@type":"ListItem","position":2,"name":"{navLabels.about}","item":"{siteUrl}#about"},{"@type":"ListItem","position":3,"name":"{navLabels.work}","item":"{siteUrl}#work"},{"@type":"ListItem","position":4,"name":"{navLabels.skills}","item":"{siteUrl}#skills"},{"@type":"ListItem","position":5,"name":"{navLabels.certifications}","item":"{siteUrl}#certifications"},{"@type":"ListItem","position":6,"name":"{navLabels.contact}","item":"{siteUrl}#contact"}]}
      ]
    }
    </script>
  </head>
  <body>
    <header class="site-header">
      <div class="container">
        <a class="logo" href={baseUrl} aria-label="Putte Arvfors Home">Puttski - Putte Arvfors</a>
        <div class="actions">
          <nav class="nav" aria-label="Primary">
            <a href={navUrls.about}>{navLabels.about}</a>
            <a href={navUrls.work}>{navLabels.work}</a>
            <a href={navUrls.skills}>{navLabels.skills}</a>
            <a href={navUrls.certifications}>{navLabels.certifications}</a>
            <a href={navUrls.contact}>{navLabels.contact}</a>
          </nav>
          <div class="language-picker">
            <button id="lang-toggle" class="button ghost" type="button" aria-label={isSwedish ? "VÃ¤lj sprÃ¥k" : "Select language"} title={isSwedish ? "VÃ¤lj sprÃ¥k" : "Select language"}>
              {lang === 'sv' ? 'ðŸ‡¸ðŸ‡ª' : 'ðŸ‡¬ðŸ‡§'}
            </button>
            <div id="lang-menu" class="lang-menu" hidden>
              <a href="/" class={lang === 'en' ? 'active' : ''}>ðŸ‡¬ðŸ‡§ English</a>
              <a href="/sv" class={lang === 'sv' ? 'active' : ''}>ðŸ‡¸ðŸ‡ª Svenska</a>
            </div>
          </div>
          <button id="theme-toggle" class="button ghost theme-toggle" type="button" aria-label="Toggle theme" title="Toggle theme">ðŸŒ“</button>
          <button id="mobile-toggle" class="button ghost menu-toggle" type="button" aria-label={isSwedish ? "Ã–ppna meny" : "Open menu"} aria-expanded="false" aria-controls="mobile-menu">â˜°</button>
        </div>
      </div>
    </header>

    <!-- Mobile menu overlay + slide-in sheet -->
    <div id="mobile-overlay" class="mobile-overlay" hidden>
      <nav id="mobile-menu" class="mobile-nav" aria-label="Mobile">
        <button class="button ghost close-btn" type="button" data-close aria-label={isSwedish ? "StÃ¤ng meny" : "Close menu"}>âœ•</button>
        <a href={navUrls.about}>{navLabels.about}</a>
        <a href={navUrls.work}>{navLabels.work}</a>
        <a href={navUrls.skills}>{navLabels.skills}</a>
        <a href={navUrls.certifications}>{navLabels.certifications}</a>
        <a href={navUrls.contact}>{navLabels.contact}</a>
        <div class="mobile-lang-links">
          <a href="/" class={lang === 'en' ? 'active' : ''}>ðŸ‡¬ðŸ‡§ English</a>
          <a href="/sv" class={lang === 'sv' ? 'active' : ''}>ðŸ‡¸ðŸ‡ª Svenska</a>
        </div>
      </nav>
    </div>

    <slot />

    <footer class="site-footer">
      <div class="container">
        <small>Â© <span id="year"></span> Putte Arvfors â€¢ {isSwedish ? 'Byggd med Nginx + Docker' : 'Built with Nginx + Docker'}</small>
      </div>
    </footer>

    <script src="/script.js?v=2" defer></script>
  </body>
  </html>
